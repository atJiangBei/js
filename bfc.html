<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<style>
			.container{
				background: fuchsia;
				overflow: hidden;
				position: relative;
			}
			.left{
				width: 100px;
				background: #666666;
				height: 200px;
				margin: 10px;
			}
			.right{
				background: #fff000;
				height: 300px;
				overflow: hidden;
				width: 100px;
				margin: 30px;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="left"></div>
			<div class="right"></div>
		</div>
	</body>
</html>

<script>
	document.cookie = 'bfchtml'
	class Components {
		constructor() {

		}
		tab = (e) => {
			console.log(e)
		}
		createElement(tag, props) {
			const on = props.on;
			const el = document.createElement(tag);
			el.innerHTML = 'test'
			el.store = {};
			if (on && typeof on === 'object') {
				for (let k in on) {
					el.store[k] = on[k]
					document.addEventListener(k, function(e) {
						if (e.target === el) {
							el.store[k].call(e.target, e)
						}
					})
				}
			}
			let eventName = '';
			return {
				el,
				on: {
					...props.on
				}
			}
		}
		render() {
			const {
				el
			} = this.createElement("div", {
				on: {
					click: this.tab
				}
			})
			return el
		}
		mount() {
			const el = this.render();
			document.body.appendChild(el)
		}
	}
	const react = new Components();
	react.mount();
</script>
<script>
	class React {
		constructor() {
			this.isSync = false;
			this.queue = [];
			this.state = {
				count: 0
			}
		}
		setState(data) {
			if (!this.isSync) {
				this.state = data;
				this.render();
			} else {
				this.queue.push({
					...this.state,
					...data
				})
			}
		}
		bacUpdate() {
			const data = this.queue[this.queue.length - 1];
			this.state = data;
			this.render();
		}
		render() {
			this.isSync = false;
		}
	}
	const rc = new React();
	//异步
	// rc.isSync = true;
	// rc.setState({count:1});
	// rc.setState({count:2});
	// console.log(rc.state.count)
	// setTimeout(()=>{
	// 	rc.setState({count:3});
	// 	console.log(rc.state.count)
	// })
	// rc.bacUpdate()
</script>


<script>
	//给定 nums = [2, 7, 11, 15], target = 9 因为 nums[0] + nums[1] = 2 + 7 = 9 所以返回 [0, 1]

	function twoSum(arr, target) {
		const map = {};
		for (var i = 0; i < arr.length; i++) {
			console.log(map, target, arr[i], target - arr[i])
			if (map[target - arr[i]] !== undefined) {
				return [map[target - arr[i]], arr[i]]
			} else {
				map[arr[i]] = i;
			}

		}
	}
	///console.log(twoSum([2, 7, 11, 15],9))
	//给定 nums = [0,1,2,2,3,0,4,2], val = 2,
	//函数应该返回新的长度 5, 并且 nums 中的前五个元素为 0, 1, 3, 0, 4。

	function removeRepeatEl(arr, target) {
		let res = 0;
		for (let i = 0; i < arr.length; i++) {
			if (arr[i] !== target) {
				arr[res++] = arr[i]
			}
		}
		return res;
	}

	//nums = [1,1,2],
	var anums = [1, 1, 2]
	var removeDuplicates = function(nums) {
		if (!nums.length) return 0;
		let j = 0;
		for (let i = 1; i < nums.length; i++) {
			if (nums[j] !== nums[i]) {
				j++;
				nums[j] = nums[i]
			}
		}
		return j + 1
	};
	//console.log(removeDuplicates(anums))
	//console.log(anums)
</script>
<script>
	const isArray = (arr) => {
		return Array.isArray(arr)
	}
	const isObj = (obj) => {
		return Object.prototype.toString.call(obj) === "[object Object]";
	}
	var obj = {
		a: {
			b: {
				c: {
					d: 1,
					h:2
				}
			}
		},
		hehe: {
			a: [1, 2],
			e: {
				a: 2,
				f:[1,2,3,{g:4}]
			},
		}
	}
	////{'a.b.c.d':1}
	const zhuan = (obj) => {
		var nbj = {};
		const setVal = (str, it) => {
			if (typeof(it) !== 'object') {
				nbj[str] = it;
			} else {
				fn(str, it)
			}
		}
		const forArray = (key,arr)=>{
			arr.forEach((it, index) => {
				var str = key ? key + ('[' + index+']') : '['+index+']';
				setVal(str, it)
			})
		}
		const forObj = (key,obj)=>{
			for(let i in obj){
				const str = key?key+'.'+i:i
				setVal(str,obj[i])
			}
		}
		const fn = (key = '', item) => {
			if(isObj(item)){
				forObj(key, item)
			}
			if (isArray(item)) {
				forArray(key,item)
			}
		}
		fn('', obj)
		console.log(nbj)
	}
	zhuan(obj)
	
	const oldObj2 = {
		a:{
			b:1
		},
		c:[
			1,2,{d:3,e:4}
		]
	}
	zhuan(oldObj2)
</script>
<!-- <script>
	new Promise((res,rej)=>{
		rej()
	}).then(()=>{
		
	}).catch(e=>{
		console.log(e)
		return  1
	}).then(e=>{
		console.log(e)
	}).then((e)=>{
		console.log(e)
	})
</script>
 -->
<script>
	class MyPromise {
		constructor(executor) {
			this.state = "pending";
			this.onResolvedCallbacks = [];
			this.onRejectedCallbacks = [];
			this.value = '';
			this.reason = '';
			const resolve = (value) => {
				this.state = 'fulfilled';
				this.value = value;
				this.onResolvedCallbacks.forEach(fn => fn())
			}
			const reject = (reason) => {
				this.state = "rejected";
				this.reason = reason
				this.onRejectedCallbacks.forEach(fn => fn())
			}
			try {
				executor(resolve, reject)
			} catch (e) {
				//TODO handle the exception
			}
		}
		then(onfulfilled, onrejected) {
			onfulfilled = typeof onfulfilled === 'function' ? onfulfilled : data => data;
			onrejected = typeof onrejected === 'function' ? onrejected : err => {
				throw err
			};
			let resolve = null;
			let reject = null;
			const pro = new MyPromise((res, rej) => {
				resolve = res, reject = rej
			});
			if (this.state === 'pending') {
				this.onResolvedCallbacks.push(() => {
					onfulfilled(this.value)
				});
				this.onRejectedCallbacks.push(() => {
					onrejected(this.reason)
				})
			}
			if (this.state === 'fulfilled') {
				try {
					const returnVal = onfulfilled(this.value);
					resolve(returnVal)
				} catch (e) {
					reject(e)
				}
			}
			if (this.state === 'rejected') {
				try {
					const returnVal = onrejected(this.reason)
					reject(returnVal)
				} catch (e) {
					reject(e)
				}

			}
			return pro;
		}
	}
	// new MyPromise((res, rej) => {
	// 	rej(1)
	// }).then((data) => {
	// 	console.log(data)
	// 	return 2
	// }, (err) => {
	// 	console.log(err)
	// }).then(e => {
	// 	console.log(e)
	// }).then(e => {
	// 	console.log(e)
	// })
</script>

