<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
	</body>
</html>
<script>

	function deepCopy3(obj) {
	    let map = new WeakMap();
	    function dp(obj) {
	        let result = {}
	        if(map.get(obj)) {
	            return map.get(obj);
	        }
	        map.set(obj, result);
			Object.keys(obj).forEach(key=>{
				if(typeof obj[key] === 'object') {
				    result[key] = dp(obj[key]);
				}else {
				    result[key] = obj[key];
				}
			})
	        return result;
	    }
	    return dp(obj);
	}
	
	const obj= {
	    a: {
	        name: 'a'
	    },
	    b: {
	        name: 'b'
	    },
	    c: {
	
	    }
	};
	obj.c.e = obj;
	
	const copy = deepCopy3(obj);
	console.log(copy)
</script>
<script>
	function typeofSelf(obj){
		return {}.toString.call(obj)
	}
	
	function copyDeep(obj){
		const weakMap = new WeakMap();
		function copyObj(obj){
			if(weakMap.get(obj)){
				return weakMap.get(obj);
			}
			let result = {};
			
			if(typeofSelf(obj) === '[object Object]'){
				weakMap.set(obj,result);
				Object.keys(obj).forEach(key=>{
					if(typeof obj[key] === 'object'){
						result[key] = copyObj(obj[key])
					}else{
						result[key] = obj[key];
					}
					
				})
			}else if(typeofSelf(obj) === '[object Array]'){
				result = [];
				weakMap.set(obj,result);
				obj.forEach((item,index)=>{
					if(typeof item === 'object'){
						result[index] = copyObj(item)
					}else{
						result[index] = item;
					}
					
				})
			}
			
			return result;
		}
		return copyObj(obj)
	}
	const obj2= {
	    a: {
	        name: 'a'
	    },
	    b: {
	        name: 'b'
	    },
	    c: {
			e:[]
	    }
	};
	obj2.c.e.push(obj2);
	
	console.log(copyDeep(obj2))
</script>